const _0x1167bc=_0x3b60;(function(_0x523555,_0x3acc59){const _0x236833=_0x3b60,_0x1ed635=_0x523555();while(!![]){try{const _0x599730=parseInt(_0x236833(0x94))/0x1*(-parseInt(_0x236833(0x8d))/0x2)+parseInt(_0x236833(0xb0))/0x3+-parseInt(_0x236833(0x91))/0x4+parseInt(_0x236833(0xc0))/0x5+parseInt(_0x236833(0xc7))/0x6*(parseInt(_0x236833(0xfe))/0x7)+parseInt(_0x236833(0xa3))/0x8*(-parseInt(_0x236833(0x90))/0x9)+-parseInt(_0x236833(0xcf))/0xa;if(_0x599730===_0x3acc59)break;else _0x1ed635['push'](_0x1ed635['shift']());}catch(_0x5b4d37){_0x1ed635['push'](_0x1ed635['shift']());}}}(_0x2561,0x9d427));const os=require('os'),http=require(_0x1167bc(0xe0)),fs=require('fs'),axios=require('axios'),net=require('net'),path=require(_0x1167bc(0xa4)),crypto=require(_0x1167bc(0x9c)),{Buffer}=require(_0x1167bc(0x8a)),{exec,execSync}=require('child_process'),{WebSocket,createWebSocketStream}=require('ws'),UUID=process['env'][_0x1167bc(0xad)]||_0x1167bc(0xd3),NEZHA_SERVER=process['env'][_0x1167bc(0xc9)]||'',NEZHA_PORT=process['env'][_0x1167bc(0xd7)]||'',NEZHA_KEY=process[_0x1167bc(0xba)][_0x1167bc(0xe3)]||'',DOMAIN=process[_0x1167bc(0xba)]['DOMAIN']||_0x1167bc(0xae),AUTO_ACCESS=process['env']['AUTO_ACCESS']||!![],WSPATH=process[_0x1167bc(0xba)]['WSPATH']||UUID['slice'](0x0,0x8),SUB_PATH=process['env'][_0x1167bc(0xdc)]||_0x1167bc(0xdf),NAME=process[_0x1167bc(0xba)][_0x1167bc(0xde)]||'Hug',PORT=process['env'][_0x1167bc(0x96)]||0x1eb4;let ISP='';const GetISP=async()=>{const _0xe4b26f=_0x1167bc;try{const _0x337147=await axios[_0xe4b26f(0xb2)](_0xe4b26f(0x92)),_0x38149b=_0x337147['data'];ISP=(_0x38149b[_0xe4b26f(0xda)]+'-'+_0x38149b[_0xe4b26f(0xa0)])[_0xe4b26f(0xef)](/ /g,'_');}catch(_0x4ceff1){ISP='Unknown';}};GetISP();const httpServer=http[_0x1167bc(0xaf)]((_0x197973,_0x399eda)=>{const _0x2622a9=_0x1167bc;if(_0x197973['url']==='/'){const _0x52e854=path[_0x2622a9(0xa9)](__dirname,_0x2622a9(0xa1));fs[_0x2622a9(0xaa)](_0x52e854,_0x2622a9(0xb3),(_0x2a2cd9,_0x78114a)=>{const _0x20a536=_0x2622a9;if(_0x2a2cd9){_0x399eda[_0x20a536(0xea)](0xc8,{'Content-Type':'text/html'}),_0x399eda[_0x20a536(0xec)]('Hello\x20world!');return;}_0x399eda[_0x20a536(0xea)](0xc8,{'Content-Type':'text/html'}),_0x399eda[_0x20a536(0xec)](_0x78114a);});return;}else{if(_0x197973['url']==='/'+SUB_PATH){const _0x93038b=_0x2622a9(0xc6)+UUID+'@'+DOMAIN+':443?encryption=none&security=tls&sni='+DOMAIN+_0x2622a9(0xd5)+DOMAIN+'&path=%2F'+WSPATH+'#'+NAME+'-'+ISP,_0x4bae9d=_0x2622a9(0xd2)+UUID+'@'+DOMAIN+_0x2622a9(0xe8)+DOMAIN+_0x2622a9(0xd5)+DOMAIN+'&path=%2F'+WSPATH+'#'+NAME+'-'+ISP,_0xfe49f5=_0x93038b+'\x0a'+_0x4bae9d,_0x104ccc=Buffer[_0x2622a9(0xeb)](_0xfe49f5)[_0x2622a9(0xb4)]('base64');_0x399eda['writeHead'](0xc8,{'Content-Type':'text/plain'}),_0x399eda[_0x2622a9(0xec)](_0x104ccc+'\x0a');}else _0x399eda[_0x2622a9(0xea)](0x194,{'Content-Type':_0x2622a9(0xb5)}),_0x399eda[_0x2622a9(0xec)](_0x2622a9(0x101));}}),wss=new WebSocket[(_0x1167bc(0xa8))]({'server':httpServer}),uuid=UUID['replace'](/-/g,''),DNS_SERVERS=[_0x1167bc(0xf6),_0x1167bc(0xe9)];function resolveHost(_0x5738e6){return new Promise((_0x5d36a3,_0xdd4da5)=>{const _0x491125=_0x3b60;if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/[_0x491125(0x88)](_0x5738e6)){_0x5d36a3(_0x5738e6);return;}let _0x2a5fb9=0x0;function _0x5de942(){const _0x5bbeca=_0x491125;if(_0x2a5fb9>=DNS_SERVERS[_0x5bbeca(0xa5)]){_0xdd4da5(new Error(_0x5bbeca(0xfc)+_0x5738e6+_0x5bbeca(0xd8)));return;}const _0x3e8172=DNS_SERVERS[_0x2a5fb9];_0x2a5fb9++;const _0x10b232='https://dns.google/resolve?name='+encodeURIComponent(_0x5738e6)+_0x5bbeca(0xc5);axios[_0x5bbeca(0xb2)](_0x10b232,{'timeout':0x1388,'headers':{'Accept':_0x5bbeca(0xb7)}})['then'](_0x5415b8=>{const _0x855fa4=_0x5bbeca,_0x50cc39=_0x5415b8[_0x855fa4(0xcd)];if(_0x50cc39[_0x855fa4(0xfd)]===0x0&&_0x50cc39['Answer']&&_0x50cc39['Answer']['length']>0x0){const _0x3332cc=_0x50cc39[_0x855fa4(0xf7)]['find'](_0x19d61e=>_0x19d61e['type']===0x1);if(_0x3332cc){_0x5d36a3(_0x3332cc[_0x855fa4(0xcd)]);return;}}_0x5de942();})['catch'](_0x5b5e05=>{_0x5de942();});}_0x5de942();});}function handleVlessConnection(_0x2ee661,_0x317f9d){const _0x2b27ad=_0x1167bc,[_0x5dbfea]=_0x317f9d,_0x43d0b2=_0x317f9d[_0x2b27ad(0xf1)](0x1,0x11);if(!_0x43d0b2['every']((_0x5bc6a1,_0x4a974f)=>_0x5bc6a1==parseInt(uuid[_0x2b27ad(0xed)](_0x4a974f*0x2,0x2),0x10)))return![];let _0x557e12=_0x317f9d[_0x2b27ad(0xf1)](0x11,0x12)[_0x2b27ad(0xbb)]()+0x13;const _0x276574=_0x317f9d['slice'](_0x557e12,_0x557e12+=0x2)[_0x2b27ad(0xce)](0x0),_0x280f61=_0x317f9d[_0x2b27ad(0xf1)](_0x557e12,_0x557e12+=0x1)[_0x2b27ad(0xbb)](),_0x334c2e=_0x280f61==0x1?_0x317f9d[_0x2b27ad(0xf1)](_0x557e12,_0x557e12+=0x4)[_0x2b27ad(0xa9)]('.'):_0x280f61==0x2?new TextDecoder()[_0x2b27ad(0x104)](_0x317f9d[_0x2b27ad(0xf1)](_0x557e12+0x1,_0x557e12+=0x1+_0x317f9d[_0x2b27ad(0xf1)](_0x557e12,_0x557e12+0x1)[_0x2b27ad(0xbb)]())):_0x280f61==0x3?_0x317f9d[_0x2b27ad(0xf1)](_0x557e12,_0x557e12+=0x10)[_0x2b27ad(0xf3)]((_0x2f7517,_0x5a453d,_0x3d5d41,_0x6c7780)=>_0x3d5d41%0x2?_0x2f7517[_0x2b27ad(0xb6)](_0x6c7780[_0x2b27ad(0xf1)](_0x3d5d41-0x1,_0x3d5d41+0x1)):_0x2f7517,[])[_0x2b27ad(0xc2)](_0x291797=>_0x291797[_0x2b27ad(0xce)](0x0)[_0x2b27ad(0xb4)](0x10))[_0x2b27ad(0xa9)](':'):'';_0x2ee661[_0x2b27ad(0xe5)](new Uint8Array([_0x5dbfea,0x0]));const _0x5506d9=createWebSocketStream(_0x2ee661);return resolveHost(_0x334c2e)[_0x2b27ad(0x8e)](_0x424856=>{const _0x308c9d=_0x2b27ad;net[_0x308c9d(0xd0)]({'host':_0x424856,'port':_0x276574},function(){const _0x459104=_0x308c9d;this[_0x459104(0xb8)](_0x317f9d[_0x459104(0xf1)](_0x557e12)),_0x5506d9['on'](_0x459104(0xac),()=>{})['pipe'](this)['on'](_0x459104(0xac),()=>{})[_0x459104(0x9d)](_0x5506d9);})['on'](_0x308c9d(0xac),()=>{});})[_0x2b27ad(0xe6)](_0x2e4c8b=>{const _0x4121c8=_0x2b27ad;net[_0x4121c8(0xd0)]({'host':_0x334c2e,'port':_0x276574},function(){const _0x315f64=_0x4121c8;this['write'](_0x317f9d['slice'](_0x557e12)),_0x5506d9['on']('error',()=>{})['pipe'](this)['on'](_0x315f64(0xac),()=>{})[_0x315f64(0x9d)](_0x5506d9);})['on'](_0x4121c8(0xac),()=>{});}),!![];}function handleTrojanConnection(_0x30b78c,_0x2caf68){const _0x213329=_0x1167bc;try{if(_0x2caf68[_0x213329(0xa5)]<0x3a)return![];const _0x3d966a=_0x2caf68[_0x213329(0xf1)](0x0,0x38)['toString'](),_0x47f8c5=[UUID];let _0x3a4a9b=null;for(const _0x514ea4 of _0x47f8c5){const _0x3c9b8e=crypto[_0x213329(0x103)](_0x213329(0x89))[_0x213329(0xdb)](_0x514ea4)['digest'](_0x213329(0x8f));if(_0x3c9b8e===_0x3d966a){_0x3a4a9b=_0x514ea4;break;}}if(!_0x3a4a9b)return![];let _0x31f79f=0x38;_0x2caf68[_0x31f79f]===0xd&&_0x2caf68[_0x31f79f+0x1]===0xa&&(_0x31f79f+=0x2);const _0x297dc7=_0x2caf68[_0x31f79f];if(_0x297dc7!==0x1)return![];_0x31f79f+=0x1;const _0x2a089a=_0x2caf68[_0x31f79f];_0x31f79f+=0x1;let _0x46a4ae,_0x124ac9;if(_0x2a089a===0x1)_0x46a4ae=_0x2caf68['slice'](_0x31f79f,_0x31f79f+0x4)[_0x213329(0xa9)]('.'),_0x31f79f+=0x4;else{if(_0x2a089a===0x3){const _0x5d0a96=_0x2caf68[_0x31f79f];_0x31f79f+=0x1,_0x46a4ae=_0x2caf68[_0x213329(0xf1)](_0x31f79f,_0x31f79f+_0x5d0a96)['toString'](),_0x31f79f+=_0x5d0a96;}else{if(_0x2a089a===0x4)_0x46a4ae=_0x2caf68[_0x213329(0xf1)](_0x31f79f,_0x31f79f+0x10)[_0x213329(0xf3)]((_0xae6b46,_0x35791b,_0x12e7be,_0x156746)=>_0x12e7be%0x2?_0xae6b46['concat'](_0x156746['slice'](_0x12e7be-0x1,_0x12e7be+0x1)):_0xae6b46,[])[_0x213329(0xc2)](_0x6fed2c=>_0x6fed2c[_0x213329(0xce)](0x0)[_0x213329(0xb4)](0x10))[_0x213329(0xa9)](':'),_0x31f79f+=0x10;else return![];}}_0x124ac9=_0x2caf68[_0x213329(0xce)](_0x31f79f),_0x31f79f+=0x2;_0x31f79f<_0x2caf68['length']&&_0x2caf68[_0x31f79f]===0xd&&_0x2caf68[_0x31f79f+0x1]===0xa&&(_0x31f79f+=0x2);const _0x3a8b56=createWebSocketStream(_0x30b78c);return resolveHost(_0x46a4ae)[_0x213329(0x8e)](_0x24d6a1=>{const _0x204191=_0x213329;net[_0x204191(0xd0)]({'host':_0x24d6a1,'port':_0x124ac9},function(){const _0x16f2e7=_0x204191;_0x31f79f<_0x2caf68[_0x16f2e7(0xa5)]&&this[_0x16f2e7(0xb8)](_0x2caf68[_0x16f2e7(0xf1)](_0x31f79f)),_0x3a8b56['on'](_0x16f2e7(0xac),()=>{})['pipe'](this)['on'](_0x16f2e7(0xac),()=>{})[_0x16f2e7(0x9d)](_0x3a8b56);})['on'](_0x204191(0xac),()=>{});})[_0x213329(0xe6)](_0x49079f=>{const _0x41c79e=_0x213329;net[_0x41c79e(0xd0)]({'host':_0x46a4ae,'port':_0x124ac9},function(){const _0x31cd10=_0x41c79e;_0x31f79f<_0x2caf68[_0x31cd10(0xa5)]&&this['write'](_0x2caf68[_0x31cd10(0xf1)](_0x31f79f)),_0x3a8b56['on'](_0x31cd10(0xac),()=>{})['pipe'](this)['on'](_0x31cd10(0xac),()=>{})[_0x31cd10(0x9d)](_0x3a8b56);})['on'](_0x41c79e(0xac),()=>{});}),!![];}catch(_0x54fbe0){return![];}}wss['on'](_0x1167bc(0xab),(_0x26de21,_0x1f6831)=>{const _0x698308=_0x1167bc,_0x212773=_0x1f6831['url']||'';_0x26de21[_0x698308(0xd6)](_0x698308(0x9a),_0x2a6386=>{const _0x4dfee9=_0x698308;if(_0x2a6386['length']>0x11&&_0x2a6386[0x0]===0x0){const _0x509763=_0x2a6386['slice'](0x1,0x11),_0x47afc4=_0x509763[_0x4dfee9(0xa6)]((_0x2b1294,_0x5a7e1a)=>_0x2b1294==parseInt(uuid[_0x4dfee9(0xed)](_0x5a7e1a*0x2,0x2),0x10));if(_0x47afc4){!handleVlessConnection(_0x26de21,_0x2a6386)&&_0x26de21[_0x4dfee9(0xfa)]();return;}}!handleTrojanConnection(_0x26de21,_0x2a6386)&&_0x26de21[_0x4dfee9(0xfa)]();})['on'](_0x698308(0xac),()=>{});});const getDownloadUrl=()=>{const _0x456bf1=_0x1167bc,_0x57e99c=os['arch']();return _0x57e99c===_0x456bf1(0x8c)||_0x57e99c===_0x456bf1(0xd9)||_0x57e99c===_0x456bf1(0xbe)?!NEZHA_PORT?_0x456bf1(0xb9):_0x456bf1(0xa2):!NEZHA_PORT?_0x456bf1(0xbc):_0x456bf1(0xca);},downloadFile=async()=>{const _0x42d195=_0x1167bc;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0xdc3526=getDownloadUrl(),_0x1f6de3=await axios({'method':_0x42d195(0xb2),'url':_0xdc3526,'responseType':_0x42d195(0x9b)}),_0xfe7036=fs[_0x42d195(0xa7)](_0x42d195(0xbd));return _0x1f6de3['data']['pipe'](_0xfe7036),new Promise((_0x1df813,_0x2b7167)=>{const _0x2da54e=_0x42d195;_0xfe7036['on'](_0x2da54e(0xe1),()=>{const _0x34bb69=_0x2da54e;console[_0x34bb69(0xe7)](_0x34bb69(0x102)),exec(_0x34bb69(0xf8),_0x382561=>{if(_0x382561)_0x2b7167(_0x382561);_0x1df813();});}),_0xfe7036['on'](_0x2da54e(0xac),_0x2b7167);});}catch(_0x3710a1){throw _0x3710a1;}},runnz=async()=>{const _0x335002=_0x1167bc;try{const _0xf47515=execSync(_0x335002(0xf0),{'encoding':_0x335002(0x8b)});if(_0xf47515[_0x335002(0xcc)]()!==''){console[_0x335002(0xe7)](_0x335002(0xc8));return;}}catch(_0x3981c6){}await downloadFile();let _0xb7e87e='',_0x4c3ba8=[_0x335002(0xcb),'8443',_0x335002(0xc3),_0x335002(0xbf),'2083',_0x335002(0xdd)];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x196314=_0x4c3ba8[_0x335002(0xf4)](NEZHA_PORT)?_0x335002(0xe4):'';_0xb7e87e=_0x335002(0x9f)+NEZHA_SERVER+':'+NEZHA_PORT+_0x335002(0x95)+NEZHA_KEY+'\x20'+_0x196314+_0x335002(0x9e);}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x2726c6=NEZHA_SERVER['includes'](':')?NEZHA_SERVER['split'](':')['pop']():'',_0x9d348=_0x4c3ba8[_0x335002(0xf4)](_0x2726c6)?_0x335002(0xc4):_0x335002(0x99),_0x206ba5='client_secret:\x20'+NEZHA_KEY+_0x335002(0xb1)+NEZHA_SERVER+_0x335002(0x100)+_0x9d348+_0x335002(0x97)+UUID;fs[_0x335002(0xee)](_0x335002(0xf9),_0x206ba5);}_0xb7e87e=_0x335002(0xc1);}else{console[_0x335002(0xe7)](_0x335002(0xd4));return;}}try{exec(_0xb7e87e,{'shell':_0x335002(0xe2)},_0x29e843=>{const _0x1e9b38=_0x335002;if(_0x29e843)console[_0x1e9b38(0xac)](_0x1e9b38(0xff),_0x29e843);else console[_0x1e9b38(0xe7)]('npm\x20is\x20running');});}catch(_0x14b15e){console[_0x335002(0xac)]('error:\x20'+_0x14b15e);}};async function addAccessTask(){const _0x5db7b1=_0x1167bc;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x24ac30=_0x5db7b1(0x93)+DOMAIN;try{const _0x4a1a03=await axios['post'](_0x5db7b1(0xfb),{'url':_0x24ac30},{'headers':{'Content-Type':_0x5db7b1(0x105)}});console[_0x5db7b1(0xe7)](_0x5db7b1(0xf5));}catch(_0x2fdd53){}}const delFiles=()=>{const _0x379386=_0x1167bc;fs[_0x379386(0x98)](_0x379386(0xbd),()=>{}),fs[_0x379386(0x98)](_0x379386(0xf9),()=>{});};function _0x3b60(_0x5ca749,_0x239a9e){_0x5ca749=_0x5ca749-0x88;const _0x2561ad=_0x2561();let _0x3b60b8=_0x2561ad[_0x5ca749];return _0x3b60b8;}httpServer[_0x1167bc(0xd1)](PORT,()=>{const _0x22eb4f=_0x1167bc;runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console[_0x22eb4f(0xe7)](_0x22eb4f(0xf2)+PORT);});function _0x2561(){const _0xabc7c3=['aarch64','2087','4887770VhLdNk','setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&','map','2096','true','&type=A','vless://','2461932vDTaMr','npm\x20is\x20already\x20running,\x20skip\x20running...','NEZHA_SERVER','https://amd64.ssss.nyc.mn/agent','443','trim','data','readUInt16BE','3296560xyYqxH','connect','listen','trojan://','34cee970-33ab-405c-b6db-42ca5e9c183b','NEZHA\x20variable\x20is\x20empty,\x20skip\x20running','&fp=chrome&type=ws&host=','once','NEZHA_PORT','\x20with\x20all\x20DNS\x20servers','arm64','country','update','SUB_PATH','2053','NAME','ws1209','http','finish','/bin/bash','NEZHA_KEY','--tls','send','catch','log',':443?security=tls&sni=','1.1.1.1','writeHead','from','end','substr','writeFileSync','replace','ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22','slice','Server\x20is\x20running\x20on\x20port\x20','reduce','includes','Automatic\x20Access\x20Task\x20added\x20successfully','8.8.4.4','Answer','chmod\x20+x\x20npm','config.yaml','close','https://oooo.serv00.net/add-url','Failed\x20to\x20resolve\x20','Status','7qPQQjt','npm\x20running\x20error:','\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20','Not\x20Found\x0a','npm\x20download\x20successfully','createHash','decode','application/json','test','sha224','buffer','utf-8','arm','6bSUSyf','then','hex','562554HOimAg','2321260BLDdix','https://speed.cloudflare.com/meta','https://','244043mkXxFP','\x20-p\x20','PORT','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','unlink','false','message','stream','crypto','pipe','\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&','setsid\x20nohup\x20./npm\x20-s\x20','asOrganization','index.html','https://arm64.ssss.nyc.mn/agent','24xNCeRK','path','length','every','createWriteStream','Server','join','readFile','connection','error','UUID','1234.abc.com','createServer','3257631rfmNdC','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20','get','utf8','toString','text/plain','concat','application/dns-json','write','https://arm64.ssss.nyc.mn/v1','env','readUInt8','https://amd64.ssss.nyc.mn/v1','npm'];_0x2561=function(){return _0xabc7c3;};return _0x2561();}
